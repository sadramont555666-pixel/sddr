# ุณุณุชู ูพุฑููุงู ู ุชูุธูุงุช ุงููุช

ุงู ุณูุฏ ูุณุชูุฏุงุช ฺฉุงูู ูุงุจูุชโูุง ูพุฑููุงู ฺฉุงุฑุจุฑ ู ุชูุธูุงุช ุงููุช ุงุณุช ฺฉู ุจุฑุง ุณุงูุงูู ฺฏุฒุงุฑุดโฺฏุฑ ูุทุงูุนู ูพุงุฏูโุณุงุฒ ุดุฏู ุงุณุช.

## ๐ ููุฑุณุช ูุทุงูุจ

1. [ูพุฑููุงู ุฏุงูุดโุขููุฒ](#ูพุฑููุงู-ุฏุงูุดุขููุฒ)
2. [ูพุฑููุงู ูุฏุฑ](#ูพุฑููุงู-ูุฏุฑ)
3. [ุชูุธูุงุช ุงููุช](#ุชูุธูุงุช-ุงููุช)
4. [API Endpoints](#api-endpoints)
5. [ุชุบุฑุงุช Database Schema](#ุชุบุฑุงุช-database-schema)

---

## ๐ ูพุฑููุงู ุฏุงูุดโุขููุฒ

### ูุณุฑ: `/student-dashboard/profile`

### ูฺฺฏโูุง:
- โ ููุงุด ุงุทูุงุนุงุช ุดุฎุต (ูุงูุ ุดูุงุฑู ุชูุงุณุ ูพุงูุ ุฑุดุชูุ ุดูุฑุ ุชุงุฑุฎ ุซุจุชโูุงู)
- โ ุขูพููุฏ ุนฺฉุณ ูพุฑููุงู (JPG, PNG - ุญุฏุงฺฉุซุฑ 200MB)
- โ ุชุบุฑ ุนฺฉุณ ูพุฑููุงู
- โ ุญุฐู ุนฺฉุณ ูพุฑููุงู
- โ ููุงุด ุนฺฉุณ ุฏุฑ Dropdown ูุฏุฑ ุฏุงุดุจูุฑุฏ

### ฺฉุงููพูููุชโูุง:
- `src/components/student/ProfileDropdown.tsx` - ููู ฺฉุดู ูพุฑููุงู ุฏุฑ ูุฏุฑ
- `src/components/student/StudentProfilePage.tsx` - ุตูุญู ุงุตู ูพุฑููุงู
- `src/app/student-dashboard/profile/page.tsx` - Route handler

### API Endpoints:
- `POST /api/profile/student/avatar` - ุขูพููุฏ ุนฺฉุณ
- `DELETE /api/profile/student/avatar` - ุญุฐู ุนฺฉุณ

---

## ๐ฉโ๐ผ ูพุฑููุงู ูุฏุฑ (ุฎุงูู ุณูฺฏโุดฺฉู)

### ูุณุฑ: `/admin/profile`

### ูฺฺฏโูุง:
- โ ูุฑุงุด ูุงู ู ูุงู ุฎุงููุงุฏฺฏ
- โ ูุฑุงุด ุดูุงุฑู ููุจุงู
- โ ุงูุฒูุฏู ุดูุงุฑู ุชูุงุณ ุซุงุจุช (ุงุฎุชุงุฑ)
- โ ุงูุฒูุฏู ุขุฏุฑุณ ุฏูุชุฑ ูุดุงูุฑ (ุงุฎุชุงุฑ)
- โ ุงูุฒูุฏู ุจูฺฏุฑุงู/ุชูุถุญุงุช (ุงุฎุชุงุฑ)
- โ ุขูพููุฏ/ุชุบุฑ/ุญุฐู ุนฺฉุณ ูพุฑููุงู (JPG, PNG - ุญุฏุงฺฉุซุฑ 200MB)
- โ ุฏฺฉูู ุฐุฎุฑู ุชุบุฑุงุช

### ฺฉุงููพูููุชโูุง:
- `src/components/admin/AdminProfileDropdown.tsx` - ููู ฺฉุดู ูพุฑููุงู ุฏุฑ ูุฏุฑ
- `src/components/admin/AdminProfilePage.tsx` - ุตูุญู ูุฑุงุด ูพุฑููุงู
- `src/app/admin/profile/page.tsx` - Route handler

### API Endpoints:
- `PUT /api/profile/admin` - ุจูโุฑูุฒุฑุณุงู ุงุทูุงุนุงุช ูพุฑููุงู
- `POST /api/profile/admin/avatar` - ุขูพููุฏ ุนฺฉุณ
- `DELETE /api/profile/admin/avatar` - ุญุฐู ุนฺฉุณ

---

## ๐ ุชูุธูุงุช ุงููุช

### ูุณุฑ: `/admin/settings/security`

### ูฺฺฏโูุง:
- โ ุชุบุฑ ุฑูุฒ ุนุจูุฑ ูุฏุฑ
- โ ุงุนุชุจุงุฑุณูุฌ ุฑูุฒ ูุนู
- โ ุงูุฒุงูุงุช ุฑูุฒ ุนุจูุฑ:
  - ุญุฏุงูู 8 ฺฉุงุฑุงฺฉุชุฑ
  - ุญุฏุงูู ฺฉ ุญุฑู (a-z ุง A-Z)
  - ุญุฏุงูู ฺฉ ุนุฏุฏ (0-9)
- โ ุชุงุฏ ุฑูุฒ ุฌุฏุฏ
- โ ููุงุด/ูุฎู ฺฉุฑุฏู ุฑูุฒ ุนุจูุฑ
- โ **Rate Limiting**: ูุญุฏูุฏุช 5 ุชูุงุด ุฏุฑ 15 ุฏููู
- โ ูพุงูโูุง ุฎุทุง ู ููููุช ูุงุถุญ
- โ ูุงฺฏ ุชุบุฑุงุช ุงููุช

### ฺฉุงููพูููุชโูุง:
- `src/components/admin/AdminSecurityPage.tsx` - ุตูุญู ุชูุธูุงุช ุงููุช
- `src/app/admin/settings/security/page.tsx` - Route handler

### API Endpoints:
- `POST /api/auth/admin/change-password` - ุชุบุฑ ุฑูุฒ ุนุจูุฑ

### ุงููุช:
```javascript
// Rate Limiting Configuration
{
  key: 'change_password',
  windowMs: 15 * 60 * 1000, // 15 ุฏููู
  limit: 5 // 5 ุชูุงุด
}
```

---

## ๐ก API Endpoints

### ุฏุงูุดโุขููุฒ

#### `POST /api/profile/student/avatar`
ุขูพููุฏ ุนฺฉุณ ูพุฑููุงู ุฏุงูุดโุขููุฒ

**Request:**
```
Content-Type: multipart/form-data
Body: { avatar: File }
```

**Response:**
```json
{
  "success": true,
  "profileImageUrl": "/uploads/avatars/xxx.jpg"
}
```

#### `DELETE /api/profile/student/avatar`
ุญุฐู ุนฺฉุณ ูพุฑููุงู ุฏุงูุดโุขููุฒ

**Response:**
```json
{
  "success": true
}
```

### ูุฏุฑ

#### `PUT /api/profile/admin`
ุจูโุฑูุฒุฑุณุงู ุงุทูุงุนุงุช ูพุฑููุงู ูุฏุฑ

**Request:**
```json
{
  "name": "ุฎุงูู ููฺฉุง ุณูฺฏโุดฺฉู",
  "phone": "09123456789",
  "landlinePhone": "02112345678",
  "officeAddress": "ุชูุฑุงูุ ุฎุงุจุงู ููุนุตุฑ",
  "bio": "ูุดุงูุฑ ุชุญุตู ุจุง 10 ุณุงู ุณุงุจูู"
}
```

**Response:**
```json
{
  "success": true,
  "user": { ... }
}
```

#### `POST /api/profile/admin/avatar`
ุขูพููุฏ ุนฺฉุณ ูพุฑููุงู ูุฏุฑ

**Request:**
```
Content-Type: multipart/form-data
Body: { avatar: File }
```

**Response:**
```json
{
  "success": true,
  "profileImageUrl": "/uploads/avatars/admin-xxx.jpg"
}
```

#### `DELETE /api/profile/admin/avatar`
ุญุฐู ุนฺฉุณ ูพุฑููุงู ูุฏุฑ

**Response:**
```json
{
  "success": true
}
```

### ุงููุช

#### `POST /api/auth/admin/change-password`
ุชุบุฑ ุฑูุฒ ุนุจูุฑ ูุฏุฑ

**Request:**
```json
{
  "currentPassword": "Admin@2024Strong",
  "newPassword": "NewPassword123"
}
```

**Response (Success):**
```json
{
  "success": true,
  "message": "ุฑูุฒ ุนุจูุฑ ุดูุง ุจุง ููููุช ุชุบุฑ ฺฉุฑุฏ"
}
```

**Response (Error):**
```json
{
  "error": "ุฑูุฒ ุนุจูุฑ ูุนู ุงุดุชุจุงู ุงุณุช",
  "field": "currentPassword"
}
```

**Response (Rate Limited):**
```json
{
  "error": "ุชุนุฏุงุฏ ุชูุงุดโูุง ุดูุง ุจุด ุงุฒ ุญุฏ ูุฌุงุฒ ุงุณุช. ูุทูุงู ฑต ุฏููู ุฏฺฏุฑ ุชูุงุด ฺฉูุฏ."
}
```

---

## ๐พ ุชุบุฑุงุช Database Schema

### ููุฏูุง ุฌุฏุฏ ุฏุฑ ุฌุฏูู `User`:

```prisma
model User {
  // ... ููุฏูุง ูุจู
  
  // Admin-specific fields
  bio           String?   // ุจูฺฏุฑุงู/ฺฉุงููุช ูุฏุฑ
  officeAddress String?   // ุขุฏุฑุณ ุฏูุชุฑ ูุดุงูุฑ
  landlinePhone String?   // ุดูุงุฑู ุชูุงุณ ุซุงุจุช
}
```

### Migration:
```bash
npx prisma migrate dev --name add_admin_profile_fields
```

---

## ๐จ UI/UX ูฺฺฏโูุง

### Dropdown ูพุฑููุงู:
- ุนฺฉุณ ูพุฑููุงู ฺฏุฑุฏ ุจุง gradient background
- ูุงู ฺฉุงุฑุจุฑ
- ููุด ุงููุดูโุฏุงุฑ
- ููู ฺฉุดู ุจุง ุงููุดู fadeIn
- ฺฏุฒููโูุง:
  - ๐ค ูุดุงูุฏู ูพุฑููุงู
  - โ๏ธ ุชูุธูุงุช
  - ๐ ุชูุธูุงุช ุงููุช (ููุท ูุฏุฑ)
  - ๐ช ุฎุฑูุฌ ุงุฒ ุญุณุงุจ

### ุตูุญู ูพุฑููุงู:
- ูุฏุฑ ุจุง gradient ุฑูฺฏ
- ุจุฎุด ุขูพููุฏ ุนฺฉุณ ุจุง preview
- ููุงุด ุงุทูุงุนุงุช ุจุง ุขฺฉููโูุง ููุงุณุจ
- ุทุฑุงุญ ุฑุณูพุงูุณู
- ุฏฺฉููโูุง ุจุง loading state

### ุตูุญู ุชูุธูุงุช ุงููุช:
- ูุฑู ุชุบุฑ ุฑูุฒ ุณู ูุฑุญููโุง
- ุฏฺฉูู ููุงุด/ูุฎู ุฑูุฒ
- ููุงุด ุงูุฒุงูุงุช ุฑูุฒ ุนุจูุฑ
- ูพุงูโูุง ุฎุทุง/ููููุช ูุงุถุญ
- ูุดุฏุงุฑ ุงููุช

---

## ๐ ุงููุช

### ุขูพููุฏ ูุงู:
- โ ุจุฑุฑุณ ููุน ูุงู (ููุท JPG, PNG)
- โ ุจุฑุฑุณ ุญุฌู ูุงู (ุญุฏุงฺฉุซุฑ 200MB)
- โ ูุงู ูุงู ููฺฉ ุจุง timestamp
- โ ุญุฐู ูุงู ูุจู ููฺฏุงู ุขูพููุฏ ุฌุฏุฏ

### ุชุบุฑ ุฑูุฒ:
- โ Rate limiting (5 ุชูุงุด ุฏุฑ 15 ุฏููู)
- โ ุงุนุชุจุงุฑุณูุฌ ุฑูุฒ ูุนู ุจุง argon2
- โ ุงูุฒุงูุงุช ูู ุจุฑุง ุฑูุฒ ุฌุฏุฏ
- โ ูุดโุณุงุฒ ุจุง argon2
- โ ูุงฺฏ ุชุบุฑุงุช ุจุฑุง audit

### ุงุญุฑุงุฒ ููุช:
- โ ุจุฑุฑุณ JWT token ุงุฒ cookie
- โ ุจุฑุฑุณ ููุด ฺฉุงุฑุจุฑ (ADMIN/STUDENT)
- โ Session management

---

## ๐ ุงุฏุฏุงุดุชโูุง ุชูุณุนู

### ุณุงุฎุชุงุฑ ูุงูโูุง:
```
src/
โโโ components/
โ   โโโ student/
โ   โ   โโโ ProfileDropdown.tsx
โ   โ   โโโ StudentProfilePage.tsx
โ   โ   โโโ StudentDashboardLayout.tsx
โ   โโโ admin/
โ       โโโ AdminProfileDropdown.tsx
โ       โโโ AdminProfilePage.tsx
โ       โโโ AdminSecurityPage.tsx
โ       โโโ AdminLayout.tsx
โโโ app/
โ   โโโ student-dashboard/
โ   โ   โโโ profile/
โ   โ       โโโ page.tsx
โ   โโโ admin/
โ   โ   โโโ profile/
โ   โ   โ   โโโ page.tsx
โ   โ   โโโ settings/
โ   โ       โโโ security/
โ   โ           โโโ page.tsx
โ   โโโ api/
โ       โโโ profile/
โ       โ   โโโ student/
โ       โ   โ   โโโ avatar/
โ       โ   โ       โโโ route.js
โ       โ   โโโ admin/
โ       โ       โโโ route.js
โ       โ       โโโ avatar/
โ       โ           โโโ route.js
โ       โโโ auth/
โ           โโโ admin/
โ               โโโ change-password/
โ                   โโโ route.js
โโโ prisma/
    โโโ migrations/
        โโโ 20251010161145_add_admin_profile_fields/
```

### Dependencies ุงุณุชูุงุฏู ุดุฏู:
- `lucide-react` - ุขฺฉููโูุง
- `@auth/create/react` - ุงุญุฑุงุฒ ููุช
- `react-router` - navigation
- `argon2` - ูุด ุฑูุฒ ุนุจูุฑ
- `prisma` - ORM

---

## โ ุชุณุชโูุง

### ุชุณุช ุฏุณุช:

1. **ูพุฑููุงู ุฏุงูุดโุขููุฒ:**
   - โ ูุฑูุฏ ุจู ุญุณุงุจ ุฏุงูุดโุขููุฒ
   - โ ฺฉูฺฉ ุฑู dropdown ูพุฑููุงู
   - โ ุฑูุชู ุจู ุตูุญู ูพุฑููุงู
   - โ ุขูพููุฏ ุนฺฉุณ ุฌุฏุฏ
   - โ ุญุฐู ุนฺฉุณ
   - โ ุจุฑุฑุณ ููุงุด ุฏุฑ header

2. **ูพุฑููุงู ูุฏุฑ:**
   - โ ูุฑูุฏ ุจู ุญุณุงุจ ูุฏุฑ
   - โ ฺฉูฺฉ ุฑู dropdown ูพุฑููุงู
   - โ ุฑูุชู ุจู ุตูุญู ูพุฑููุงู
   - โ ูุฑุงุด ููู ููุฏูุง
   - โ ุขูพููุฏ ุนฺฉุณ
   - โ ุฐุฎุฑู ุชุบุฑุงุช

3. **ุชูุธูุงุช ุงููุช:**
   - โ ุฑูุชู ุจู ุตูุญู ุชูุธูุงุช ุงููุช
   - โ ุชุณุช ุฑูุฒ ูุนู ุงุดุชุจุงู
   - โ ุชุณุช ุฑูุฒ ุฌุฏุฏ ุถุนู
   - โ ุชุณุช ุนุฏู ูุทุงุจูุช ุฑูุฒูุง
   - โ ุชุบุฑ ุฑูุฒ ูููู
   - โ ุชุณุช rate limiting

---

## ๐ ุฑูุน ูุดฺฉูุงุช ุฑุงุฌ

### ูุดฺฉู: ุนฺฉุณ ุขูพููุฏ ููโุดูุฏ
**ุฑุงู ุญู:**
```bash
# ุงุฌุงุฏ ุฏุงุฑฺฉุชูุฑ uploads
mkdir -p public/uploads/avatars
chmod 755 public/uploads/avatars
```

### ูุดฺฉู: ุฎุทุง 401 Unauthorized
**ุฑุงู ุญู:**
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู AUTH_SECRET ุฏุฑ .env ุชูุธู ุดุฏู ุจุงุดุฏ
- ูุทูุฆู ุดูุฏ ฺฉู ฺฉูฺฉ session ุจู ุฏุฑุณุช ุณุช ุดุฏู ุงุณุช
- ฺฉูฺฉโูุง ูุฑูุฑฺฏุฑ ุฑุง ูพุงฺฉ ฺฉูุฏ ู ุฏูุจุงุฑู ูุงฺฏู ฺฉูุฏ

### ูุดฺฉู: Rate limiting ฺฉุงุฑ ููโฺฉูุฏ
**ุฑุงู ุญู:**
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู `rateLimit` utility ุจู ุฏุฑุณุช import ุดุฏู ุจุงุดุฏ
- ูุทูุฆู ุดูุฏ ฺฉู Redis ุง in-memory store ูุนุงู ุงุณุช

---

## ๐ง ูพุดุชุจุงู

ุจุฑุง ฺฏุฒุงุฑุด ุจุงฺฏ ุง ุฏุฑุฎูุงุณุช ูฺฺฏ ุฌุฏุฏุ ูุทูุงู ฺฉ Issue ุฏุฑ GitHub ุจุงุฒ ฺฉูุฏ.

---

**ูุณุฎู:** 1.0.0  
**ุชุงุฑุฎ:** 2025-10-10  
**ููุณูุฏู:** ุชูุณุนูโุฏููุฏู Full-Stack

