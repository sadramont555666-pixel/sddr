# Ø³ÛŒØ³ØªÙ… Ù„ÛŒØ³Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¯Ùˆ Ø¨Ø®Ø´ÛŒ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØª Ø³Ù†Ø¬Ø§Ù‚

Ù…Ø³ØªÙ†Ø¯Ø§Øª Ú©Ø§Ù…Ù„ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ù„ÛŒØ³Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¯Ø± Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø¯Ù…ÛŒÙ†

## ğŸ“‹ ÙÙ‡Ø±Ø³Øª

1. [Ø®Ù„Ø§ØµÙ‡ Ø³ÛŒØ³ØªÙ…](#Ø®Ù„Ø§ØµÙ‡-Ø³ÛŒØ³ØªÙ…)
2. [ØªØºÛŒÛŒØ±Ø§Øª Database](#ØªØºÛŒÛŒØ±Ø§Øª-database)
3. [ØªØºÛŒÛŒØ±Ø§Øª Backend](#ØªØºÛŒÛŒØ±Ø§Øª-backend)
4. [ØªØºÛŒÛŒØ±Ø§Øª Frontend](#ØªØºÛŒÛŒØ±Ø§Øª-frontend)
5. [Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡](#Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ-Ø§Ø³ØªÙØ§Ø¯Ù‡)
6. [Testing](#testing)

---

## ğŸ¯ Ø®Ù„Ø§ØµÙ‡ Ø³ÛŒØ³ØªÙ…

Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø¨Ù‡ Ø§Ø¯Ù…ÛŒÙ† Ø§Ø¬Ø§Ø²Ù‡ Ù…ÛŒâ€ŒØ¯Ù‡Ø¯ ØªØ§ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø±Ø§ Ø¨Ù‡ Ø¯Ùˆ Ø¯Ø³ØªÙ‡ ØªÙ‚Ø³ÛŒÙ… Ú©Ù†Ø¯:

### **1. Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡ (Pinned)**
- Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± Ø¨Ø§Ù„Ø§ÛŒ Ù„ÛŒØ³Øª Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- **Ø¨Ø¯ÙˆÙ† ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ** - Ù‡Ù…Ù‡ Ø¯Ø± ÛŒÚ© Ù†Ú¯Ø§Ù‡ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ø³ØªÙ†Ø¯
- Ø¨Ø§ Ø±Ù†Ú¯ Ùˆ Ø§Ø³ØªØ§ÛŒÙ„ Ù…ØªÙ…Ø§ÛŒØ² Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- Ø§ÛŒØ¯Ù‡â€ŒØ¢Ù„ Ø¨Ø±Ø§ÛŒ: Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† VIPØŒ Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ ØªÙˆØ¬Ù‡ ÙˆÛŒÚ˜Ù‡ØŒ ÛŒØ§ Ù…ÙˆØ§Ø±Ø¯ ÙÙˆØ±ÛŒ

### **2. Ø³Ø§ÛŒØ± Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† (Normal)**
- Ø¯Ø± Ø²ÛŒØ± Ù„ÛŒØ³Øª Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡â€ŒÙ‡Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
- **Ø¨Ø§ ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ** - Ù‡Ø± ØµÙØ­Ù‡ Û²Û¸ Ù†ÙØ± (Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…)
- Ø¨Ø§ Ø§Ø³ØªØ§ÛŒÙ„ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯

### **3. Ø¯Ú©Ù…Ù‡ Ø³Ù†Ø¬Ø§Ù‚ (Pin Button)**
- ÛŒÚ© Ø¢ÛŒÚ©ÙˆÙ† Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ Ú©ÙˆÚ†Ú© Ø¯Ø± Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ù‡Ø± Ú©Ø§Ø±Øª
- **Pinned:** Ø¯Ø§ÛŒØ±Ù‡ Ø²Ø±Ø¯ ØªÙˆÙ¾ÙØ± Ø¨Ø§ Ø¢ÛŒÚ©ÙˆÙ† Ø³ÙÛŒØ¯
- **Not Pinned:** Ø¯Ø§ÛŒØ±Ù‡ Ø®Ø§Ú©Ø³ØªØ±ÛŒ ØªÙˆØ®Ø§Ù„ÛŒ
- Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ø¢Ù† â†’ Ø¬Ø§Ø¨Ø¬Ø§ÛŒÛŒ ÙÙˆØ±ÛŒ Ø¨ÛŒÙ† Ø¯Ùˆ Ù„ÛŒØ³Øª

---

## ğŸ’¾ ØªØºÛŒÛŒØ±Ø§Øª Database

### Schema Update

ÙÛŒÙ„Ø¯ `pinned` Ø¨Ù‡ Ù…Ø¯Ù„ `User` Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯:

```prisma
model User {
  // ... existing fields
  pinned Boolean @default(false) // Ø¨Ø±Ø§ÛŒ Ø³Ù†Ø¬Ø§Ù‚ Ú©Ø±Ø¯Ù† Ø¯Ø± Ù„ÛŒØ³Øª
  
  // ... relations
}
```

### Migration

```bash
# Migration Ù‚Ø¨Ù„Ø§Ù‹ Ø§Ø¬Ø±Ø§ Ø´Ø¯Ù‡ Ø§Ø³Øª
npx prisma migrate dev --name add_pinned_to_user
```

---

## ğŸ”§ ØªØºÛŒÛŒØ±Ø§Øª Backend

### 1. API Endpoint: Toggle Pin Status

**Ù…Ø³ÛŒØ±:** `PATCH /api/admin/users/:userId/toggle-pin`

**Ú©Ø§Ø±Ø¨Ø±Ø¯:** ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª Ø³Ù†Ø¬Ø§Ù‚ ÛŒÚ© Ú©Ø§Ø±Ø¨Ø±

**Authentication:** Ù†ÛŒØ§Ø²Ù…Ù†Ø¯ Ù†Ù‚Ø´ ADMIN

**Request:**
```http
PATCH /api/admin/users/clx123.../toggle-pin
Cookie: authjs.session-token=...
```

**Response (Success):**
```json
{
  "success": true,
  "message": "Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ù„ÛŒØ³Øª Ø§Ø¹Ø¶Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯",
  "user": {
    "id": "clx...",
    "name": "Ø¹Ù„ÛŒ Ø§Ø­Ù…Ø¯ÛŒ",
    "pinned": true,
    "profileImageUrl": null,
    "role": "STUDENT",
    "grade": "Ø¯Ù‡Ù…",
    "field": "Ø±ÛŒØ§Ø¶ÛŒ",
    "phone": "09123456789"
  }
}
```

**Ù…Ù†Ø·Ù‚:**
1. Ø¯Ø±ÛŒØ§ÙØª `userId` Ø§Ø² URL params
2. ÛŒØ§ÙØªÙ† Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± database
3. Ø¨Ø±Ø¹Ú©Ø³ Ú©Ø±Ø¯Ù† Ù…Ù‚Ø¯Ø§Ø± `pinned` (`true` â†’ `false` ÛŒØ§ Ø¨Ø±Ø¹Ú©Ø³)
4. Ø¨Ø§Ø²Ú¯Ø´Øª Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯Ù‡

**Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:**
```typescript
// src/app/api/admin/users/[userId]/toggle-pin/route.js
async function togglePinHandler(request, { params }) {
  const user = await getUserFromRequest(request);
  
  // Check admin role
  if (user.role !== 'ADMIN') {
    return Response.json({ error: 'Unauthorized' }, { status: 403 });
  }

  const { userId } = params;
  
  // Get current user
  const targetUser = await prisma.user.findUnique({
    where: { id: userId },
    select: { pinned: true },
  });

  // Toggle pinned status
  const updatedUser = await prisma.user.update({
    where: { id: userId },
    data: { pinned: !targetUser.pinned },
  });

  return Response.json({ success: true, user: updatedUser });
}

export async function PATCH(request, { params }) {
  return await togglePinHandler(request, { params });
}
```

---

### 2. API Endpoint: List Students (Updated)

**Ù…Ø³ÛŒØ±:** `GET /api/admin/students`

**ØªØºÛŒÛŒØ±Ø§Øª:**
- Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù† ÙÛŒÙ„Ø¯ `pinned` Ø¨Ù‡ response
- Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ `pinned` (Ù†Ø²ÙˆÙ„ÛŒ) Ø³Ù¾Ø³ `createdAt`

**Response:**
```json
{
  "items": [
    {
      "id": "clx...",
      "name": "Ø³Ø§Ø±Ø§ Ø±Ø¶Ø§ÛŒÛŒ",
      "pinned": true,    // â† Ø¬Ø¯ÛŒØ¯
      "grade": "ÛŒØ§Ø²Ø¯Ù‡Ù…",
      "pendingReportsCount": 3,
      // ... other fields
    },
    {
      "id": "clx...",
      "name": "Ù…Ø­Ù…Ø¯ Ø¬ÙˆØ§Ø¯ÛŒ",
      "pinned": false,   // â† Ø¬Ø¯ÛŒØ¯
      "grade": "Ø¯Ù‡Ù…",
      "pendingReportsCount": 1,
      // ... other fields
    }
  ],
  "total": 45,
  "page": 1,
  "pageSize": 28
}
```

**Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:**
```typescript
// src/server/controllers/admin/students.ts
const students = await prisma.user.findMany({
  where: { role: 'STUDENT' },
  select: {
    id: true,
    name: true,
    pinned: true,  // â† Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯
    // ... other fields
  },
  orderBy: [
    { pinned: 'desc' }, // â† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡â€ŒÙ‡Ø§ Ø§ÙˆÙ„
    { createdAt: 'desc' },
  ],
  skip,
  take: pageSize,
});
```

---

## ğŸ¨ ØªØºÛŒÛŒØ±Ø§Øª Frontend

### 1. Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ø¬Ø¯ÛŒØ¯: `StudentsGridDual.tsx`

**Ù…Ø³ÛŒØ±:** `src/components/admin/StudentsGridDual.tsx`

**ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:**
- âœ… ØªÙÚ©ÛŒÚ© Ø®ÙˆØ¯Ú©Ø§Ø± Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¨Ù‡ Ø¯Ùˆ Ù„ÛŒØ³Øª
- âœ… Ø¢ÛŒÚ©ÙˆÙ† Ø³Ù†Ø¬Ø§Ù‚ Ø¯Ø± Ù‡Ø± Ú©Ø§Ø±Øª
- âœ… refetch Ø®ÙˆØ¯Ú©Ø§Ø± Ù¾Ø³ Ø§Ø² toggle
- âœ… UI ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§ (responsive)
- âœ… Ù†Ù…Ø§ÛŒØ´ ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø± Ù‡Ø± Ø¨Ø®Ø´

**Ø³Ø§Ø®ØªØ§Ø±:**
```tsx
export default function StudentsGridDual() {
  const { data, refetch } = useAdminStudents(page);
  const items = data?.items ?? [];
  
  // ØªÙÚ©ÛŒÚ© Ø¨Ù‡ Ø¯Ùˆ Ù„ÛŒØ³Øª
  const pinnedUsers = items.filter(s => s.pinned === true);
  const normalUsers = items.filter(s => s.pinned !== true);

  // ØªØ§Ø¨Ø¹ toggle
  const handleTogglePin = async (studentId, currentPinned) => {
    await fetch(`/api/admin/users/${studentId}/toggle-pin`, {
      method: 'PATCH',
    });
    refetch(); // â† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
  };

  return (
    <div className="space-y-8">
      {/* Ø¨Ø®Ø´ Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡ */}
      {pinnedUsers.length > 0 && (
        <div className="bg-yellow-50 border-yellow-200">
          <h2>Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡</h2>
          <div className="grid">
            {pinnedUsers.map(s => (
              <StudentCard student={s} isPinned={true} />
            ))}
          </div>
        </div>
      )}
      
      {/* Ø¨Ø®Ø´ Ø¹Ø§Ø¯ÛŒ */}
      <div className="bg-white">
        <h2>Ø³Ø§ÛŒØ± Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†</h2>
        <div className="grid">
          {normalUsers.map(s => (
            <StudentCard student={s} isPinned={false} />
          ))}
        </div>
        {/* ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ ÙÙ‚Ø· Ø§ÛŒÙ†Ø¬Ø§ */}
        <Pagination />
      </div>
    </div>
  );
}
```

---

### 2. Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª Ú©Ø§Ø±Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²

**ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§:**
- Ø¢ÛŒÚ©ÙˆÙ† Ø³Ù†Ø¬Ø§Ù‚ Ø¯Ø± Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾
- Ø§Ø³ØªØ§ÛŒÙ„ Ù…ØªÙØ§ÙˆØª Ø¨Ø±Ø§ÛŒ pinned/normal
- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª (Ù…Ø´Ø§Ù‡Ø¯Ù‡ØŒ Ù…Ø³Ø¯ÙˆØ¯)

**Ù¾ÛŒØ§Ø¯Ù‡â€ŒØ³Ø§Ø²ÛŒ:**
```tsx
const StudentCard = ({ student, isPinned }) => (
  <div className={`border rounded-lg p-3 relative ${
    isPinned ? 'border-yellow-400 bg-yellow-50' : ''
  }`}>
    {/* Ø¢ÛŒÚ©ÙˆÙ† Ø³Ù†Ø¬Ø§Ù‚ */}
    <button
      onClick={() => handleTogglePin(student.id, student.pinned)}
      className={`absolute top-2 left-2 p-1.5 rounded-full ${
        student.pinned
          ? 'bg-yellow-500 hover:bg-yellow-600'
          : 'bg-gray-200 hover:bg-gray-300'
      }`}
    >
      <Pin className={`w-3.5 h-3.5 ${
        student.pinned ? 'text-white fill-white' : 'text-gray-600'
      }`} />
    </button>

    {/* Ù…Ø­ØªÙˆØ§ÛŒ Ú©Ø§Ø±Øª */}
    <img src={student.profileImageUrl} />
    <div>{student.name}</div>
    <div>Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±: {student.pendingReportsCount}</div>
    
    {/* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª */}
    <a href={`/admin/students/${student.id}`}>Ù…Ø´Ø§Ù‡Ø¯Ù‡</a>
    <button>Ù…Ø³Ø¯ÙˆØ¯</button>
  </div>
);
```

---

### 3. ØµÙØ­Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø¯Ù…ÛŒÙ† (Updated)

**Ù…Ø³ÛŒØ±:** `src/app/admin/page.tsx`

**ØªØºÛŒÛŒØ±:**
```tsx
// Ù‚Ø¨Ù„:
import StudentsGrid from '@/components/admin/StudentsGrid';

// Ø¨Ø¹Ø¯:
import StudentsGridDual from '@/components/admin/StudentsGridDual';

export default function Page() {
  return (
    <AdminLayout>
      {/* Stats cards */}
      <StudentsGridDual /> {/* â† Ø¨Ù‡ Ø¬Ø§ÛŒ StudentsGrid */}
    </AdminLayout>
  );
}
```

---

## ğŸ“– Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø§Ø³ØªÙØ§Ø¯Ù‡

### Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ†

#### Ø³Ù†Ø¬Ø§Ù‚ Ú©Ø±Ø¯Ù† Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²

1. Ø¯Ø± Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø¯Ù…ÛŒÙ† (`/admin`), Ù„ÛŒØ³Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯
2. Ø±ÙˆÛŒ **Ø¢ÛŒÚ©ÙˆÙ† Ø¯Ø§ÛŒØ±Ù‡ Ø®Ø§Ú©Ø³ØªØ±ÛŒ** (âšª) Ø¯Ø± Ú¯ÙˆØ´Ù‡ Ø¨Ø§Ù„Ø§-Ú†Ù¾ Ú©Ø§Ø±Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
3. Ø¢ÛŒÚ©ÙˆÙ† ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ **Ø¯Ø§ÛŒØ±Ù‡ Ø²Ø±Ø¯** (ğŸŸ¡) Ù…ÛŒâ€ŒØ´ÙˆØ¯
4. Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¨Ù‡ Ø¨Ø®Ø´ "Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡" Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯
5. **Ø¨Ø¯ÙˆÙ† Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø±ÙØ±Ø´ ØµÙØ­Ù‡!**

#### Ø­Ø°Ù Ø§Ø² Ø³Ù†Ø¬Ø§Ù‚

1. Ø±ÙˆÛŒ **Ø¢ÛŒÚ©ÙˆÙ† Ø¯Ø§ÛŒØ±Ù‡ Ø²Ø±Ø¯** (ğŸŸ¡) Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯
2. Ø¢ÛŒÚ©ÙˆÙ† ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ **Ø¯Ø§ÛŒØ±Ù‡ Ø®Ø§Ú©Ø³ØªØ±ÛŒ** (âšª) Ù…ÛŒâ€ŒØ´ÙˆØ¯
3. Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¨Ù‡ Ø¨Ø®Ø´ "Ø³Ø§ÛŒØ± Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†" Ù…Ù†ØªÙ‚Ù„ Ù…ÛŒâ€ŒØ´ÙˆØ¯

#### ØªØµÙˆÛŒØ± Ø³ÛŒØ³ØªÙ…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø¯Ù…ÛŒÙ†                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ]                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Œ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡ [3]                       â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚ â”‚ğŸŸ¡ Pin    â”‚ â”‚ğŸŸ¡ Pin    â”‚ â”‚ğŸŸ¡ Pin    â”‚             â”‚
â”‚ â”‚ğŸ‘¤ Ø³Ø§Ø±Ø§   â”‚ â”‚ğŸ‘¤ Ø¹Ù„ÛŒ    â”‚ â”‚ğŸ‘¤ Ø²Ù‡Ø±Ø§   â”‚             â”‚
â”‚ â”‚ğŸ“Š 3 Ú¯Ø²Ø§Ø±Ø´â”‚ â”‚ğŸ“Š 5 Ú¯Ø²Ø§Ø±Ø´â”‚ â”‚ğŸ“Š 2 Ú¯Ø²Ø§Ø±Ø´â”‚             â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Ø³Ø§ÛŒØ± Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† [42]                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚ â”‚âšª Pin    â”‚ â”‚âšª Pin    â”‚ â”‚âšª Pin    â”‚ â”‚âšª Pin    â”‚â”‚
â”‚ â”‚ğŸ‘¤ Ù…Ø­Ù…Ø¯   â”‚ â”‚ğŸ‘¤ ÙØ§Ø·Ù…Ù‡  â”‚ â”‚ğŸ‘¤ Ø­Ø³ÛŒÙ†   â”‚ â”‚ğŸ‘¤ Ù…Ø±ÛŒÙ…   â”‚â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                     â”‚
â”‚ [Ù‚Ø¨Ù„ÛŒ]  ØµÙØ­Ù‡ 1 Ø§Ø² 2  [Ø¨Ø¹Ø¯ÛŒ]  â† ÙÙ‚Ø· Ø§ÛŒÙ†Ø¬Ø§          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª Testing

### Manual Testing

#### 1. ØªØ³Øª Ø³Ù†Ø¬Ø§Ù‚ Ú©Ø±Ø¯Ù†

```bash
# Ù„Ø§Ú¯ÛŒÙ† Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø§Ø¯Ù…ÛŒÙ†
# Ø±ÙØªÙ† Ø¨Ù‡ /admin
# Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ÛŒÚ© Ø¢ÛŒÚ©ÙˆÙ† Ø®Ø§Ú©Ø³ØªØ±ÛŒ
# Ø¨Ø±Ø±Ø³ÛŒ:
âœ“ Ø¢ÛŒÚ©ÙˆÙ† Ø¨Ù‡ Ø²Ø±Ø¯ ØªØ¨Ø¯ÛŒÙ„ Ø´Ø¯ØŸ
âœ“ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¨Ù‡ Ø¨Ø§Ù„Ø§ÛŒ Ù„ÛŒØ³Øª Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯ØŸ
âœ“ Ø¨Ø¯ÙˆÙ† Ø±ÙØ±Ø´ ØµÙØ­Ù‡ØŸ
```

#### 2. ØªØ³Øª Ø­Ø°Ù Ø§Ø² Ø³Ù†Ø¬Ø§Ù‚

```bash
# Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ÛŒÚ© Ø¢ÛŒÚ©ÙˆÙ† Ø²Ø±Ø¯
# Ø¨Ø±Ø±Ø³ÛŒ:
âœ“ Ø¢ÛŒÚ©ÙˆÙ† Ø¨Ù‡ Ø®Ø§Ú©Ø³ØªØ±ÛŒ ØªØ¨Ø¯ÛŒÙ„ Ø´Ø¯ØŸ
âœ“ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¨Ù‡ Ù„ÛŒØ³Øª Ø¹Ø§Ø¯ÛŒ Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯ØŸ
```

#### 3. ØªØ³Øª ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ

```bash
# Ø±ÙØªÙ† Ø¨Ù‡ ØµÙØ­Ù‡ 2
# Ø¨Ø±Ø±Ø³ÛŒ:
âœ“ Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø³Ù†Ø¬Ø§Ù‚â€ŒØ´Ø¯Ù‡ Ù‡Ù…Ú†Ù†Ø§Ù† Ø¯Ø± Ø¨Ø§Ù„Ø§ Ù‡Ø³ØªÙ†Ø¯ØŸ
âœ“ ÙÙ‚Ø· Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù† Ø¹Ø§Ø¯ÛŒ ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ Ø¯Ø§Ø±Ù†Ø¯ØŸ
```

---

### API Testing

```bash
# ØªØ³Øª toggle pin
curl -X PATCH http://localhost:4000/api/admin/users/USER_ID/toggle-pin \
  -H "Cookie: authjs.session-token=..." \
  | jq

# Expected response:
{
  "success": true,
  "message": "Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ù„ÛŒØ³Øª Ø§Ø¹Ø¶Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯",
  "user": {
    "id": "...",
    "pinned": true,
    ...
  }
}

# ØªØ³Øª Ù„ÛŒØ³Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†
curl http://localhost:4000/api/admin/students \
  -H "Cookie: authjs.session-token=..." \
  | jq '.items[] | select(.pinned == true)'
```

---

## ğŸ› Troubleshooting

### Ù…Ø´Ú©Ù„: Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ² Ø¬Ø§Ø¨Ø¬Ø§ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ø¹Ù„Øª:** `refetch()` ÙØ±Ø§Ø®ÙˆØ§Ù†ÛŒ Ù†Ø´Ø¯Ù‡  
**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```tsx
const { data, refetch } = useAdminStudents(page);

const handleTogglePin = async (studentId) => {
  await fetch(...);
  await refetch(); // â† Ø§ÛŒÙ† Ø®Ø· Ø¶Ø±ÙˆØ±ÛŒ Ø§Ø³Øª
};
```

---

### Ù…Ø´Ú©Ù„: Ø¢ÛŒÚ©ÙˆÙ† Ø³Ù†Ø¬Ø§Ù‚ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ø¹Ù„Øª:** ÙÛŒÙ„Ø¯ `pinned` Ø¯Ø± API response Ù†ÛŒØ³Øª  
**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```typescript
// Ø¯Ø± students.ts controller
select: {
  id: true,
  name: true,
  pinned: true, // â† Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯
}
```

---

### Ù…Ø´Ú©Ù„: Ø§Ø±ÙˆØ± 403 Forbidden

**Ø¹Ù„Øª:** Ú©Ø§Ø±Ø¨Ø± Ø§Ø¯Ù…ÛŒÙ† Ù†ÛŒØ³Øª  
**Ø±Ø§Ù‡â€ŒØ­Ù„:**
```bash
# Ø¨Ø±Ø±Ø³ÛŒ session
console.log(session?.user?.role); // Ø¨Ø§ÛŒØ¯ 'ADMIN' Ø¨Ø§Ø´Ø¯
```

---

## ğŸ“Š Ù…Ù‚Ø§ÛŒØ³Ù‡ Ù‚Ø¨Ù„ Ùˆ Ø¨Ø¹Ø¯

| ÙˆÛŒÚ˜Ú¯ÛŒ | Ù‚Ø¨Ù„ | Ø¨Ø¹Ø¯ |
|-------|-----|-----|
| **Ù„ÛŒØ³Øª Ø¯Ø§Ù†Ø´â€ŒØ¢Ù…ÙˆØ²Ø§Ù†** | ØªÚ© Ù„ÛŒØ³Øª | Ø¯Ùˆ Ù„ÛŒØ³Øª (pinned + normal) |
| **Ø³Ù†Ø¬Ø§Ù‚ Ú©Ø±Ø¯Ù†** | âŒ | âœ… Ø¢ÛŒÚ©ÙˆÙ† Ø¯Ø§ÛŒØ±Ù‡â€ŒØ§ÛŒ |
| **ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ** | Ø¨Ø±Ø§ÛŒ Ù‡Ù…Ù‡ | ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ normal |
| **Visual Feedback** | Ù…Ø¹Ù…ÙˆÙ„ÛŒ | pinned Ø¨Ø§ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ø²Ø±Ø¯ |
| **Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ** | âŒ | âœ… Ø®ÙˆØ¯Ú©Ø§Ø± |

---

## ğŸš€ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡!

Ù‡Ù…Ù‡ Ú†ÛŒØ² Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª:

1. âœ… Database schema Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯Ù‡ (ÙÛŒÙ„Ø¯ `pinned`)
2. âœ… API endpoint Ø¨Ø±Ø§ÛŒ toggle (`PATCH /api/admin/users/:id/toggle-pin`)
3. âœ… API endpoint Ù„ÛŒØ³Øª Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯Ù‡ (Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§ `pinned`)
4. âœ… Ú©Ø§Ù…Ù¾ÙˆÙ†Ù†Øª `StudentsGridDual` Ø¨Ø§ Ø¯Ùˆ Ø¨Ø®Ø´
5. âœ… ØµÙØ­Ù‡ Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§Ø¯Ù…ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯Ù‡

**Ø¨Ø±Ø§ÛŒ ØªØ³Øª:**
```
http://localhost:4000/admin
```

**Ø§Ø¯Ù…ÛŒÙ† credentials:**
```
Phone: 09923182082
Password: Admin@2024Strong
```

---

**Ù†Ø³Ø®Ù‡:** 1.0.0  
**ØªØ§Ø±ÛŒØ®:** 2025-10-11  
**Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ:** Full-Stack Development Team

