# راهنمای سریع استفاده از سیستم جدید

## 🚀 آماده‌سازی

### 1. اطمینان از اجرای سرور
```bash
cd create/apps/web
npm run dev
# یا
npm start
```

### 2. ورود به عنوان ادمین
- URL: `http://localhost:3000/account/signin`
- از حساب ادمین خود استفاده کنید

---

## 📊 بخش 1: مشاهده گزارش‌های دانش‌آموزان

### مسیر: `/admin/students`

1. وارد صفحه دانش‌آموزان شوید
2. روی هر دانش‌آموز کلیک کنید
3. در پایین صفحه، بخش **"تاریخچه گزارش‌ها و بازخوردهای ادمین"** را مشاهده کنید

### چه چیزی نمایش داده می‌شود؟
- ✅ تمام گزارش‌های ثبت شده توسط دانش‌آموز
- ✅ جزئیات هر گزارش (موضوع، منبع آزمون، تعداد تست، زمان مطالعه)
- ✅ فایل‌های پیوست (در صورت وجود)
- ✅ بازخورد ادمین به هر گزارش
- ✅ تاریخ و ساعت دقیق

### اگر گزارشی نبود؟
پیام **"هیچ گزارشی برای نمایش وجود ندارد"** نمایش داده می‌شود.

---

## 💬 بخش 2: مدیریت پیام‌ها

### مسیر: `/admin/messages`

این صفحه دو بخش دارد:

### ستون سمت راست (لیست مکالمات)
- 📋 لیست تمام دانش‌آموزانی که با شما پیام رد و بدل کرده‌اند
- 🌐 "چت عمومی" در بالای لیست
- 🕒 آخرین پیام و زمان ارسال برای هر مکالمه

### ستون سمت چپ (محتوای مکالمه)

#### برای مکالمات خصوصی:
1. روی نام دانش‌آموز کلیک کنید
2. تمام پیام‌های قبلی را مشاهده کنید
3. در کادر پایین، پیام خود را بنویسید
4. Enter بزنید یا روی دکمه "ارسال" کلیک کنید

**نکات:**
- پیام‌های ادمین با رنگ **بنفش** نمایش داده می‌شوند
- پیام‌های دانش‌آموز با **رنگ سفید** و حاشیه خاکستری

#### برای چت عمومی:
1. روی "چت عمومی" کلیک کنید
2. تمام پیام‌های عمومی دانش‌آموزان را مشاهده کنید
3. کنار هر پیام دانش‌آموز، دکمه **"حذف"** قرمز وجود دارد
4. برای حذف پیام نامناسب، روی "حذف" کلیک کنید

**⚠️ توجه:** ادمین نمی‌تواند در چت عمومی پیام ارسال کند، فقط می‌تواند پیام‌ها را مشاهده و حذف کند.

---

## 🔍 نکات مهم

### امنیت
- ✅ فقط ادمین می‌تواند این صفحات را ببیند
- ✅ پیام‌های حذف شده در دیتابیس نگهداری می‌شوند (برای رعایت قوانین)

### عملکرد
- 🔄 صفحه به صورت خودکار به انتهای مکالمه scroll می‌کند
- ⏳ در حین ارسال پیام، دکمه غیرفعال می‌شود
- ❌ خطاها با رنگ قرمز در بالای صفحه نمایش داده می‌شوند

### تست سیستم
برای اطمینان از عملکرد:

1. **تست گزارش‌ها:**
   - با حساب دانش‌آموز یک گزارش ثبت کنید
   - با حساب ادمین وارد صفحه آن دانش‌آموز شوید
   - گزارش باید نمایش داده شود

2. **تست پیام خصوصی:**
   - دانش‌آموز یک پیام خصوصی به ادمین ارسال کند
   - ادمین وارد `/admin/messages` شود
   - نام دانش‌آموز در لیست مکالمات ظاهر می‌شود
   - ادمین می‌تواند پاسخ دهد

3. **تست چت عمومی:**
   - دانش‌آموز در چت عمومی پیام بفرستد
   - ادمین وارد "چت عمومی" شود
   - می‌تواند پیام را ببیند و حذف کند

---

## 🆘 عیب‌یابی

### اگر گزارش‌ها نمایش داده نشدند:
1. Console مرورگر را بررسی کنید (F12)
2. مطمئن شوید با حساب ادمین وارد شده‌اید
3. بررسی کنید که API endpoint در دسترس است: `/api/reports/student/[studentId]`

### اگر پیام‌ها نمایش داده نشدند:
1. مطمئن شوید دیتابیس ChatMessage دارد
2. بررسی کنید که دانش‌آموز واقعاً پیام ارسال کرده است
3. Console را برای خطاهای network بررسی کنید

### اگر خطای 500 دریافت کردید:
1. لاگ سرور را بررسی کنید
2. مطمئن شوید Prisma Client به‌روز است: `npx prisma generate`
3. اتصال به دیتابیس را بررسی کنید

---

## 📞 پشتیبانی

تمام API endpoints با console.log مجهز هستند:
- ✅ درخواست موفق: `[GET /api/...]`
- ❌ خطا: `[ERROR] ...`

برای بررسی عملکرد، لاگ‌های سرور را مشاهده کنید.

---

**نسخه**: 1.0.0  
**تاریخ**: 2025-10-13  
**وضعیت**: ✅ آماده استفاده

